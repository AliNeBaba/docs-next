# Гидратация клиентской части

Гидратация относится к процессу на стороне клиента, во время которого Vue получает статический HTML, отправленный сервером, и превращает его в динамический DOM, который может реагировать на изменения данных на стороне клиента.

В файле `entry-client.js` приложение просто монтируется с помощью этой строки:

```js
app.mount('#app')
```

Но, поскольку сервер уже отрисовал разметку, очевидно что не следует её выбрасывать и заново создавать все элементы DOM. Вместо этого, лучше «гидратировать» статическую разметку чтобы сделать её интерактивной.

Vue предоставляет метод `createSSRApp` дя использования в коде клиентской части (в данном случае в файле `entry-client.js`), чтобы сказать Vue на необходимости гидратировать существующий статический HTML вместо повторного пересоздания всех элементов DOM.

### Предостережения при гидратации

Vue будет проверять соответствие сгенерированного на стороне клиента виртуального дерева DOM структуре DOM, отрисованной на стороне сервера. Если будет выявлено несоответствие, то гидратация будет прекращена, весь существующий DOM будет отброшен и отрисовка выполнится с нуля. В консоли браузера также будет выведено предупреждение, но приложение будет работать.

Первый ключевой момент, стоит убедиться, что SSR работает — сравнить что состояние приложения одинаково и на клиенте и на сервере. Будьте особенно внимательны, чтобы не зависеть от API, специфичных для браузера (таких как ширина окна, возможности устройства или localStorage) или для сервера (таких как встроенные модули Node), и будьте внимательны вт ех случаях, когда один и тот же код будет давать разные результаты при выполнении в разных местах (например, при использовании временных зон, меток времени, нормализации URL или генерации случайных чисел). Более подробную информацию смотрите в разделе [написание универсального кода](universal.md).

Второй ключевой момент, о котором следует помнить при использовании SSR + клиентской гидратации заключается в том, что недопустимый HTML может быть изменён браузером. Например, если написать в шаблоне Vue:

```html
<table>
  <tr>
    <td>hi</td>
  </tr>
</table>
```

Браузер автоматически добавит `<tbody>` внутри `<table>`, однако виртуальный DOM, сгенерированный Vue не содержит `<tbody>`, поэтому это приведёт к несоответствию. Чтобы обеспечить корректное соответствие, убедитесь, что в шаблонах написан корректный HTML.

Можно воспользоваться валидатором HTML, например сервисом [W3C Markup Validation](https://validator.w3.org/) или [HTML-validate](https://html-validate.org/) для проверки шаблонов при разработке.
