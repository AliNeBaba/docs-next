# Руководство по отрисовке на стороне сервера

> Данное руководство находится в стадии активной разработки

## Что такое серверный рендеринг (SSR)?

Vue.js — фреймворк для создания приложений, выполняемых на стороне клиента. По умолчанию компоненты Vue создают и манипулируют DOM в браузере. Однако, можно также преобразовывать те же компоненты в HTML-строки на сервере, отправлять их в браузер, и наконец «гидратировать» статическую разметку в полностью интерактивное приложение на клиенте.

Приложение Vue.js с отрисовкой на сервере можно также считать «изоморфным» или «универсальным». Это означает, что большая часть кода приложения **выполняется и на сервере и на клиенте**.

## Нужен ли вам SSR?

По сравнению с традиционным SPA (Single-Page Application), преимуществами отрисовки на стороне сервера будут:

- Лучшая поисковая оптимизация (SEO), потому что поисковые роботы будут видеть полностью отрисованную страницу.

  Обратите внимание, что на данный момент Google и Bing могут без проблем индексировать синхронные приложения JavaScript. Ключевое слово здесь — синхронные. Если приложение запускается с индикатором загрузки, а затем получает контент через запрос к API, то поисковый робот просто не будет дожидаться окончания загрузки. Это означает, что если есть контент, получаемый асинхронно, на страницах, где важен SEO, то отрисовка на стороне сервера необходима.

- Лучшие показатели времени до отображения контента (time-to-content), особенно при медленном интернет-соединении или на медленных устройствах. Для разметки, отрисованной на стороне сервере, не нужно дожидаться пока весь JavaScript загрузится и выполнится, поэтому пользователь быстрее увидит полностью отрендеренную страницу. Это приводит к улучшению пользовательского опыта и может иметь решающее значение для приложений, в которых время до отображения контента напрямую связано с коэффициентом конверсии.

Есть также некоторые компромиссы, которые необходимо учитывать при использовании отрисовке на стороне сервера:

- Ограничения при разработке. Код, специфичный для браузера, можно использовать лишь в определённых хуках жизненного цикла; некоторые внешние библиотеки могут нуждаться в особом подходе для запуска в приложении с отрисовкой на стороне сервера.

- Более сложные требования к настройке и развёртыванию сборки. В отличие от полностью статичного SPA, которое может быть развёрнуто на любом статичном файловом сервере, для приложения с отрисовкой на стороне сервера требуется окружение, в котором может работать сервер Node.js.

- Повышенная нагрузка на сервер. Рендеринг полноценного приложения в Node.js будет более требовательным к процессору, нежели простая раздача статичных файлов, поэтому если ожидаете большой трафик, то будьте готовы к соответствующей нагрузке на сервер и применяйте стратегии кэширования.

Прежде чем использовать отрисовку на стороне сервера для приложения, первый вопрос, который нужно задать себе, это действительно ли он так нужен. Например, если разрабатываете панель мониторинга для внутренних нужд, где дополнительные несколько сотен миллисекунд начальной загрузки не так важны, то отрисовка на стороне сервера будет излишеством. Однако, в случаях, когда время до контента абсолютно критично, отрисовка на стороне сервера позволит достичь наилучшей производительности начальной загрузки.

## SSR vs Пререндеринг

Если интересуетесь отрисовкой на стороне сервера только для улучшения SEO на паре маркетинговых страниц (например, `/`, `/about`, `/contact`, и т.д.), то вероятно лучше использовать **пререндеринг**. Вместо того, чтобы использовать веб-сервер для компиляции HTML на лету, пререндеринг просто сгенерирует статичные HTML-файлы для определённых маршрутов на этапе сборки. Преимущество в том, что его настройка намного проще и позволяет сохранить фронтенд как полностью статический сайт.

Если используете [webpack](https://webpack.js.org/), то можно добавить пререндеринг с помощью [prerender-spa-plugin](https://github.com/chrisvfritz/prerender-spa-plugin). Он был тщательно протестирован на приложениях Vue.

## Об этом руководстве

<!-- [//]: # 'TODO: This guide is focused on server-rendered Single-Page Applications using Node.js as the server. Mixing Vue SSR with other backend setups is a topic of its own and briefly discussed in a [dedicated section].' -->

Это руководство будет очень подробным и предполагает, что уже знакомы с самим Vue.js, а также имеете достаточные знания по Node.js и webpack.

<!-- [//]: # 'If you prefer a higher-level solution that provides a smooth out-of-the-box experience, you should probably give [Nuxt.js](https://nuxtjs.org/) a try. It's built upon the same Vue stack but abstracts away a lot of the boilerplate, and provides some extra features such as static site generation. However, it may not suit your use case if you need more direct control of your app's structure. Regardless, it would still be beneficial to read through this guide to understand better how things work together.' -->

[//]: # 'TODO: As you read along, it would be helpful to refer to the official [HackerNews Demo](https://github.com/vuejs/vue-hackernews-2.0/), which makes use of most of the techniques covered in this guide'

Наконец, обратите внимание, что решения в этом руководстве не являются окончательными — они хорошо работают для нас, но это не значит, что их нельзя улучшить. Они могут быть пересмотрены в будущем — не стесняйтесь вносить свой вклад, предлагая пулл-реквесты с исправлениями!
